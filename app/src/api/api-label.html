<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="./api-behavior.html">

<dom-module id="api-label">
  <template>
  
    <iron-ajax id="xhr"
      url="[[url]]"
      method="POST"
      handle-as="json"
      content-type="application/json"
      body="[[_body]]"
      loading="{{loading}}"
      last-error="{{_ajaxError}}"
      last-response="{{_results}}"></iron-ajax>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'api-label',
        behaviors: [
          HiveOSS.ApiBehavior
        ],
        properties: {
          uid: String,
          url: {
            type: String,
            value: 'api/label'
          },
          valid: {
            type: Boolean,
            notify: true,
            computed: '_isValid(_body)'
          },
          _body: {
            type: Object,
            computed: '_computeBody(labeldata,prj,uid)'
          },
          prj: {
            type: Array
          }
        },

        _isValid: function(body) {
          return body && true;
        },

        _computeBody: function(data, prj, uid) {
          if (!data || !prj || !uid)
            return;

          return {
            uid: uid,
            prj: prj,
            data: data
          };
        },

        submitData: function(data) {
          this.labeldata = data;
          this.generateRequest();
        }
      });
    })();
  </script>
</dom-module>
