<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="./project-settings.html">
<link rel="import" href="./project-list.html">
<link rel="import" href="api/api-project.html">
<link rel="import" href="api/api-settings.html">

<dom-module id="project-page">
	<template>
		<style>
			:host {
				display: block;
			}
			project-list { isplay: block !important; }
			neon-animated-pages .iron-selected:not(.neon-animating) { position: relative; }
			neon-animated-pages  > :first-child:not(.iron-selected):not(.neon-animating) {
				display: block !important;
			}
			neon-animated-pages { min-height: 600px; }
		</style>

		<api-project id="project" uid="[[uid]]" project-list="{{projectList}}"></api-project>
		<api-settings id="settings" uid="[[uid]]" save="[[save]]" project="[[project]]" settings="{{settings}}"></api-settings>

		<neon-animated-pages id="pages" selected="0">
	    <project-list project-list="{{projectList}}" default-project="[[defaultProject]]" project="{{project}}" on-open-settings="toggleSettings"></project-list>
      <project-settings project="[[project]]" settings="[[settings]]" on-close-settings="toggleSettings" on-save-settings="saveSettings"></project-settings>
    </neon-animated-pages>

	</template>
	<script>
		Polymer({
			is: 'project-page',

			properties: {
				visible: {
					type: Boolean,
					observer: '_visibleChanged'
				},
				uid: String,
				save: Object,
				settings: Object,
				defaultProject: String
			},

			_visibleChanged: function(vis) {
				if (vis) {
					this.$.project.getProjects();
				}
			},

			toggleSettings: function(e) {
				if (this.$.pages.selected === 1) {
					this.$.pages.selected = 0;
					return;
				}
				this.$.pages.selected = 1;
				this.$.settings.getSettings();
			},

			saveSettings: function(e, info) {
				this.save = info;
				this.$.settings.generateRequest();
			}
		});
	</script>
</dom-module>